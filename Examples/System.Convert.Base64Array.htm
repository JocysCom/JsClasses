<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="-1" />
    <title>System.Convert.Base64Array</title>
    <link rel="stylesheet" type="text/css" href="../System.Web.UI.Interface.debug.css" />
    <link rel="stylesheet" type="text/css" href="Styles/Default.css" />

    <script src="../Includes/jquery-1.12.4.js"></script>

    <script type="text/javascript" src="../System.debug.js"></script>

    <script type="text/javascript" src="../System.Text.debug.js"></script>

    <script type="text/javascript" src="../System.Convert.debug.js"></script>

    <script type="text/javascript" src="../System.Web.UI.debug.js"></script>
    <!-- SyntaxHighlighter -->
    <link type="text/css" rel="stylesheet" href="../Documents/SyntaxHighlighter/styles/shCoreDefault.css" />
    <link type="text/css" rel="stylesheet" href="../Documents/SyntaxHighlighter/styles/shThemeDefault.css" />
    <script type="text/javascript" src="../Documents/SyntaxHighlighter/scripts/shCore.js"></script>
    <script type="text/javascript" src="../Documents/SyntaxHighlighter/scripts/shBrushJScript.js"></script>
    <script type="text/javascript" src="../Documents/SyntaxHighlighter/scripts/shBrushCSharp.js"></script>

    <script type="text/javascript">

        function Window_Load() {
            Trace.IsEnabled = true;
            Trace.Write("Start Demo");
            $("#ResetButton").on('click', ResetButton_Click);
            $("#ClearDecryptedButton").on('click', ClearDecryptedButton_Click);
            $("#ClearEncryptedButton").on('click', ClearEncryptedButton_Click);
            $("#EncryptButton").on('click', EncryptButton_Click);
            $("#DecryptButton").on('click', DecryptButton_Click);
            $("#EncryptUrlButton").on('click', EncryptUrlButton_Click);
            $("#DecryptUrlButton").on('click', DecryptUrlButton_Click);
            ResetButton_Click();
            SyntaxHighlighter.all();
        }

        $(Window_Load);

        function ResetButton_Click(sender, e) {
            $("#DecryptedTextBox").val("abė新闻网");
        }

        function ClearDecryptedButton_Click(sender, e) {
            $("#DecryptedTextBox").val("");
        }

        function ClearEncryptedButton_Click(sender, e) {
            $("#EncryptedTextBox").val("");
        }

        //#region base64

        function EncryptButton_Click(sender, e) {
            $("#EncryptedTextBox").val("");
            var text = $("#DecryptedTextBox").val();
            Trace.Write("----------------------------");
            Trace.Write("var bytes = System.Text.Encoding.UTF8.GetBytes(text);");
            var bytes = System.Text.Encoding.UTF8.GetBytes(text);
            Trace.Write("var base64 =  System.Convert.ToBase64String(bytes);");
            var base64 = System.Convert.ToBase64String(bytes);
            Trace.Write("// base64url: " + base64);
            $("#EncryptedTextBox").val(base64);
        }

        function DecryptButton_Click(sender, e) {
            $("#DecryptedTextBox").val("");
            var base64 = $("#EncryptedTextBox").val();
            Trace.Write("----------------------------");
            Trace.Write("var bytes = System.Convert.FromBase64String(base64);");
            var bytes = System.Convert.FromBase64String(base64);
            Trace.Write("var text = System.Text.Encoding.UTF8.GetString(bytes);");
            var text = System.Text.Encoding.UTF8.GetString(bytes);
            Trace.Write("// text: " + text);
            $("#DecryptedTextBox").val(text);
        }

        //#endregion

        //#region base64url

        function EncryptUrlButton_Click(sender, e) {
            $("#EncryptedTextBox").val("");
            var text = $("#DecryptedTextBox").val();
            Trace.Write("----------------------------");
            Trace.Write("var bytes = System.Text.Encoding.UTF8.GetBytes(text);");
            var bytes = System.Text.Encoding.UTF8.GetBytes(text);
            Trace.Write("var base64 = System.Web.HttpServerUtility.UrlTokenEncode(bytes);");
            var base64 = System.Web.HttpServerUtility.UrlTokenEncode(bytes);
            Trace.Write("// base64url: " + base64);
            $("#EncryptedTextBox").val(base64);
        }

        function DecryptUrlButton_Click(sender, e) {
            $("#DecryptedTextBox").val("");
            var base64 = $("#EncryptedTextBox").val();
            Trace.Write("----------------------------");
            Trace.Write("var bytes = System.Web.HttpServerUtility.UrlTokenDecode(base64);");
            var bytes = System.Web.HttpServerUtility.UrlTokenDecode(base64);
            Trace.Write("var text = System.Text.Encoding.UTF8.GetString(bytes);");
            var text = System.Text.Encoding.UTF8.GetString(bytes);
            Trace.Write("// text: " + text);
            $("#DecryptedTextBox").val(text);
        }

        //#endregion

    </script>

</head>
<body>
    <table border="0" cellpadding="0" cellspacing="4">
        <tbody>
            <tr>
                <td>Text:</td>
                <td colspan="2">
                    <textarea id="DecryptedTextBox" cols="64" rows="10"></textarea>
                </td>
                <td valign="top"><input id="ClearDecryptedButton" value="Clear" type="button" /><br /><input id="ResetButton" value="Reset" type="button" style="margin-top: 4px;" /></td>
            </tr>
            <tr>
                <td></td>
                <td>
                    Base64
                </td>
                <td style="float: right;">
                    Base64URL (URL/Filename safe)
                </td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <input id="EncryptButton" value="↓ - Encrypt" type="button" />
                    <input id="DecryptButton" value="↑ - Decrypt" type="button" />
                </td>
                <td style="float: right;">
                    <input id="EncryptUrlButton" value="↓ - Encrypt" type="button" />
                    <input id="DecryptUrlButton" value="↑ - Decrypt" type="button" />
                </td>
                <td></td>
            </tr>
            <tr>
                <td>Base64:</td>
                <td colspan="2">
                    <textarea id="EncryptedTextBox" cols="64" rows="10"></textarea>
                </td>
                <td valign="top"><input id="ClearEncryptedButton" value="Clear" type="button" /></td>
            </tr>
        </tbody>
    </table>
    <div id="TraceLog" style="width: 100%; height: 200px;"></div>


    <div style="background-color: #cccccc; padding: 16px 4px 4px 16px; margin-top: 16px;">
        <span style="font-weight: bold;">C# Notes</span>
        <pre id="ExampleCodePanel" class="brush: csharp;" style="margin: 0 0 0 0;">// C# static methods for Base64 encoding/decoding:
public static byte[] System.Convert.FromBase64String(string input);
public static string System.ConvertToBase64String(byte[] input);
// C# static methods for Base64URL (URL and filename safe) encoding/decoding:
public static byte[] System.Web.HttpServerUtility.UrlTokenDecode(string input);
public static string System.Web.HttpServerUtility.UrlTokenEncode(byte[] input);</pre>
    </div>

</body>
</html>
